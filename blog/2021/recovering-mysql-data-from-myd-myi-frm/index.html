<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd"> <html><body> <h2 id="recovering-mysql-data-from-myi-myd-frm-files">Recovering MySQL data from .MYI, .MYD, .FRM files</h2> <p>###Summary</p> <ul> <li>Identifying the hexdump of the version number of the .frm file</li> <li>Installing that version of MySQL https://downloads.mysql.com/archives/community/</li> <li>Starting it up</li> <li>Resetting the password</li> <li>Creating a new database</li> <li>Moving the data to that database folder</li> <li>using mysqldump to dump the data to a CSV format</li> </ul> <h2 id="what-version-of-mysql-to-install">What version of MySQL to install?</h2> <p>Drawing inspiration from the <a href="https://www.percona.com/blog/2015/07/09/obtain-mysql-version-frm-file/" rel="external nofollow noopener" target="_blank">percona blog</a>, as long as the version is old enough, you can make use of the <code class="language-plaintext highlighter-rouge">hexdump</code> command to identify what version of MySQL to install.</p> <p>Execute the following hexdump call to look at the first two bytes of the <code class="language-plaintext highlighter-rouge">.frm</code> file (the version number is stored at a 0x33 offset): <code class="language-plaintext highlighter-rouge">hexdump -s 0x33 -n 2 -v -d /var/lib/mysql/tweetdata/tweets.frm</code></p> <p>For our data we got the following result:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>0000033   50704                                               
0000035
</code></pre></div></div> <p>Which suggests that we should install version 5.7.4 as that must have been the last version that the table was built / altered on.</p> <p>###Downloading MySQL If you need to download an older version of MySQL you can navigate to <a href="https://downloads.mysql.com/archives/community/" rel="external nofollow noopener" target="_blank">this archive page</a>:</p> <p><img src="/assets/images/mysql_archive.png" alt="MySQL Archive page"></p> <p>We downloaded the .tar ball for the RPM bundle (345 M at the top).</p> <p>###Installing</p> <p>After downloading the tar ball we extract and run <code class="language-plaintext highlighter-rouge">sudo yum localinstall MySQL-shared-5.7.4_m14-1.linux_glibc2.5.x86_64.rpm</code></p> <p>on each of the <code class="language-plaintext highlighter-rouge">.rpm</code> files you need (for us this was the server, client, and shared).</p> <p><a href="https://web.archive.org/web/20170810042727/https://dev.mysql.com/doc/refman/5.5/en/mysql-install-db.html" rel="external nofollow noopener" target="_blank"></a></p> <p>Since we are using version 5.7.4 we can call mysql_install_db to do some heavy lifting in setup:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>mysql_install_db --user=mysql \
         --basedir=/opt/mysql/mysql \
         --datadir=/opt/mysql/mysql/data
</code></pre></div></div> <p>Now you can copy your .FRM, .MYD, .MYI files into your data directory!</p> <h3 id="starting-up">Starting up</h3> <p>If your installation includes <code class="language-plaintext highlighter-rouge">mysqld_safe</code> run:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>mysqld_safe --user=mysql &amp;
</code></pre></div></div> <p>You may also be able to run: <code class="language-plaintext highlighter-rouge">systemctl start mysqld</code></p> <p>Access the server with the client: <code class="language-plaintext highlighter-rouge">mysql -u root -p</code></p> <p>You will have to reset your password, and if it doesn’t prompt you already you can try:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>SET PASSWORD FOR 'root'@'localhost' = PASSWORD('New_Password');
</code></pre></div></div> <p>You can then create a new database which will create a database folder in the data directory we passed to <code class="language-plaintext highlighter-rouge">mysql_install_db</code>. After copying the .FRM, .MYD, .MYI files into that directory you should be able to see a table within that directory!</p> <h3 id="dumping-the-data-to-csv">Dumping the data to CSV</h3> <p>Finally, once the table is available, you can call mysqldump to dump the data to csv:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>mysqldump -u [username] -p -t -T/path/to/directory [database] [tableName] --fields-terminated-by=,
</code></pre></div></div> <p>By default it may not give you column names, which wasn’t really a problem for us, but if you need column names, there are <a href="https://stackoverflow.com/questions/262924/how-to-export-dump-a-mysql-table-into-a-text-file-including-the-field-names-a" rel="external nofollow noopener" target="_blank">alternate ways</a> to dump the data that may work for you.</p> <p>Hope that helps! </p> </body></html>